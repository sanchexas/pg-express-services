- ### [Задание](#задание-1)
- ### [Реализация](#реализация-1)
- ### [Инструкция по запуску](#инструкция-по-запуску-1)
- ### [Запросы в эндпоинты api](#запросы-в-эндпоинты-api-1)

### [Демо-видео](https://sanches-peres.netlify.app/media/demo-task.mp4)

### Задание

Нужно реализовать 2 сервиса. Один сервис пользователей, другой сервис истории действий с
пользователями. В сервисе пользователей должно быть 3 endpoint:

1 Создание пользователя
2 Изменение пользователя
3 Получение списка пользователей

В сервис “истории действий с пользователями” нужно отправлять события создания пользователя и изменения.
Общение сервисов может происходить любым способом. Сервис “истории действий с пользователями” должен иметь ручку, которая отдаст историю действий с фильтрами по id пользователя и постраничной навигацией.
Фреймворк так же может быть любой.
Один из сервисов должен быть на JS, для второго можно использовать TS.
СУБД - postgresql.

## Реализация
Фреймфорк - Express.js

На реализацию было потрачено 1.5 дня (или дней?) с момента получения задания (12 окт. 2023), дедлайн - 7 дней.

.env файлы специально НЕ были помещены в .gitignore, так как проект является тестовым заданием от компании. В реальных проектах так делать не стоит.
### Структура проекта:
- api сервис пользователей (TS)
- api сервис истории действий пользователей (JS)
- база данных PostgreSQL
![img](https://github.com/sanchexas/pg-express-services/blob/master/API_STRUCTURE.PNG)
### Диаграмма базы данных
![img](https://github.com/sanchexas/pg-express-services/blob/master/DB_DIAGRAM.PNG)

## Инструкция по запуску

1 Клонировать проект
- `git clone https://github.com/sanchexas/pg-express-services.git`

2 Открыть терминал в главной папке и прописать команды для установки npm пакетов:
- `cd user-api-service`
- `npm i`
- `cd..`
- `cd user-history-api-service`
- `npm i`

3 Запустить postgres сервер и импортировать DUMP.sql, название БД - udb ;

4 Отредактируйте значения переменных .env в двух api под ваши конфиги postgres-а ;

5 Запуск сервисов осуществляется по двум командам:
- режим разработки `npm run dev`
- обычный старт `npm start` или `npm run start`

## Запросы в эндпоинты api
Для совершения запросов была использована утилита [Postman](https://www.postman.com/downloads/)
### api сервис пользователя (папка user-api-service)

PORT: 1001

Создание пользователей:
- (POST) `http://localhost:1001/users/create`
- Обязательные поля и их типы: `name: string`, `surname: string`, `city: string`, `age: number`

Обновление пользователей:
- (PUT) `http://localhost:1001/users/update/10` (id можно поменять)
- Обязательные поля и их типы: `name: string`, `surname: string`, `city: string`, `age: number`

Получение всех пользователей:
- (GET) `http://localhost:1001/users`

### api сервис истории действий с пользователем (папка user-history-api-service)

PORT: 1002

Сохранение действия пользователя (запрос делается из user-api-service после создании или редактирования пользователя):
- (POST) `http://localhost:1002/save`
- Обязательные поля и их типы: `user_id: number`, `activity_type: 'update' | 'create'`

Получение истории по ID пользователя с разбивкой на страницы и количеством элементов на одной странице:
- Структура запроса (GET) `http://localhost:1002/byuser/<id пользователя>?page=<номер страницы>&limit=<количество элементов на страницу>`
- Пример запроса (GET) `http://localhost:1002/byuser/10?page=1&limit=2`
- Обязательные параметры запроса: `<id пользователя>`
- Дефолтные значения для остальных параметров: `page`=1 , `limit`=3